/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java project to get you started.
 * For more details take a look at the Java Quickstart chapter in the Gradle
 * user guide available at https://docs.gradle.org/4.6/userguide/tutorial_java_projects.html
 */

plugins {
    id 'java'
    id 'application'
}

// Define the main class for the application
mainClassName = 'de.samuelschepp.vokabeltrainer.Vokabeltrainer'

dependencies {
    compile group: 'org.slick2d', name: 'slick2d-core', version: '1.0.1'
}

// In this section you declare where to find the dependencies of your project
repositories {
    // Use jcenter for resolving your dependencies.
    // You can declare any Maven/Ivy/file repository here.
    jcenter()
}

distZip {
    into(project.name) {
        from '.'
        include 'textures/*'
    }

    into(project.name) {
        from 'src/main/script'
        include 'run.sh'
        fileMode = 0755
    }

    into(project.name) {
        from 'build/scripts'
        exclude '*'
    }
}



jar {
    manifest {
        attributes  'Main-Class': 'de.samuelschepp.vokabeltrainer.Vokabeltrainer',
                "Class-Path": configurations.compile.collect { it.getName() }.join(' ')
    }
}

task buildRunable {
    dependsOn build

    doLast {
        println(configurations.compile.files)
        copy {
            from configurations.compile.files
            into "${buildDir}/natives"
        }
        copy {
            from zipTree("${buildDir}/distributions/Vokabeltrainer.zip")
            into "${buildDir}/run"
        }
        copy {
            from zipTree("${buildDir}/natives/jinput-platform-2.0.5-natives-linux.jar")
            from zipTree("${buildDir}/natives/jinput-platform-2.0.5-natives-osx.jar")
            from zipTree("${buildDir}/natives/jinput-platform-2.0.5-natives-windows.jar")
            from zipTree("${buildDir}/natives/lwjgl-platform-2.9.1-natives-linux.jar")
            from zipTree("${buildDir}/natives/lwjgl-platform-2.9.1-natives-osx.jar")
            from zipTree("${buildDir}/natives/lwjgl-platform-2.9.1-natives-windows.jar")
            into "${buildDir}/run/Vokabeltrainer/lib"
        }
    }
}

task runBuild {
    dependsOn buildRunable

    doLast {
        exec {
            commandLine "${buildDir}/run/Vokabeltrainer/run.sh"
        }
    }
}
